---
author: Ika (@ikatyang)
authorURL: https://github.com/ikatyang
title: "Prettier 1.16: HTML improvements and better CRLF handling"
---

This release improves HTML formatting and contains better CRLF handling, new
syntax features, and several bugfixes.

<!--truncate-->

## Highlights

### HTML

#### Respect surrounding linebreaks ([#5596] by [@ikatyang])

Previously, Prettier always put elements in a single line if they fit the print
width, but it is not suitable for cases that is used as lists or `if-else`
blocks. To solve this problem, we'll respect surrounding linebreaks for all
elements since there is no reliable way to determine if it's used as lists.

<!-- prettier-ignore -->
```html
<!-- Input -->
<div class="list">
  <div class="item">Jan</div>
</div>
<a v-if="i !== -1" href="#" @click.prevent="select(i)">
  {{ i }}
</a>
<span v-else>
  <slot name="ellipsis">&hellip;</slot>
</span>

<!-- Output (Prettier 1.15) -->
<div class="list"><div class="item">Jan</div></div>
<a v-if="i !== -1" href="#" @click.prevent="select(i)"> {{ i }} </a>
<span v-else> <slot name="ellipsis">&hellip;</slot> </span>

<!-- Output (Prettier 1.16) -->
<div class="list">
  <div class="item">Jan</div>
</div>
<a v-if="i !== -1" href="#" @click.prevent="select(i)">
  {{ i }}
</a>
<span v-else>
  <slot name="ellipsis">&hellip;</slot>
</span>
```

### General

#### Better CRLF handling ([#5494] by [@ikatyang])

You might have noticed a few weird things happened only on Windows, which is
usually caused by the bad CRLF handling. In this release, we completely get rid
of them by normalizing linebreaks before/after formatting.

### JavaScript

#### Improve the pattern used by React hooks ([#5608] by [@j-f1])

<!-- prettier-ignore -->
```js
// Input
function helloWorld() {
  useEffect(() => {
    // do something
  }, [props.value])
}

// Output (Prettier 1.15)
function helloWorld() {
  useEffect(
    () => {
      // do something
    },
    [props.value]
  );
}

// Output (Prettier 1.16)
function helloWorld() {
  useEffect(() => {
    // do something
  }, [props.value]);
}
```

#### Rename `babylon` with `babel` ([#5647] by [@wuweiweiwu])

`babylon` was renamed with `@babel/parser` in Babel 7, we reflected this change
in 1.16 so that it should be easier to understand for newcomers.

(`babylon` is now deprecated but still works.)

### Flow

#### Add `babel-flow` parser ([#5685] by [@ikatyang])

As we mentioned in the docs, both `babylon` and `flow` support Flow syntax, but
there're a few edge cases that the syntax could be ambiguous, which causes the
inconsistency between `babylon` and `flow`, `babylon` prefers JavaScript while
`flow` prefers Flow. To address this issue, we added `babel-flow` in this
release, which uses the same parser as `babylon` but prefers Flow.

<!-- prettier-ignore -->
```js
// Input
const Theme = React.createContext<"light" | "dark">("light");

// Output (Prettier 1.15, --parser babylon)
const Theme = (React.createContext < "light") | ("dark" > "light");

// Output (Prettier 1.16, --parser babel-flow)
const Theme = React.createContext<"light" | "dark">("light");
```

### CLI

#### Add `--check` flag ([#5629] by [@kachkaev])

There's a `--list-different` flag that is used to fail the CI if one of the
input files is not formatted, which works great but we found that its _error
message_ is not human-friendly but machine-friendly, so we added a `--check`
flag to output something human-friendly.

<code style="display: block; background: #282a36; color: #f1f1f0">
<span style="color: #686868"># Prettier 1.15</span><br />
$ <span style="color: #5af78e">prettier</span> <u>*.js</u> --list-different<br />
unformatted.js<br />
<br />
<span style="color: #686868"># Prettier 1.16</span><br />
$ <span style="color: #5af78e">prettier</span> <u>*.js</u> --check<br />
Checking formatting...<br />
unformatted.js<br />
Code style issues found in the above file(s). Forgot to run Prettier?<br />
</code>

## Other changes

### General

#### Fix unexpected formatting caused by range format ([#5632] by [@lhchavez])

<!-- prettier-ignore -->
```js
// Input
something("something", () => {
  const something = {
    something: [
      {
        long1: "longlonglonglonglonglonglonglonglonglonglonglong",
        long2: "longlonglonglonglonglonglonglonglonglonglonglong",
      }
    ]
  };
});

// Output (Prettier 1.15, --range-start 100 --range-end 120)
something("something", () => {
  const something = { something: [{ long1: "longlonglonglonglonglonglonglonglonglonglonglong", long2: "longlonglonglonglonglonglonglonglonglonglonglong" }] };
});

// Output (Prettier 1.16, --range-start 100 --range-end 120)
something("something", () => {
  const something = {
    something: [
      {
        long1: "longlonglonglonglonglonglonglonglonglonglonglong",
        long2: "longlonglonglonglonglonglonglonglonglonglonglong",
      }
    ]
  };
});
```

### Standalone

#### Remove the dynamic `require()` call in the standalone bundle ([#5612] by [@j-f1])

Previously, dynamic `require()`s are still presented in the standalone bundle
even if it's not used, which causes a warning if you'd like to bundle it. We
have removed those unnecessary `require()`s in 1.16.

### TypeScript

#### Correctly handle `//` in TSX ([#5728] by [@JamesHenry])

Previously, `//`s in TSX were wrongly treated as comments, it's now fixed.

<!-- prettier-ignore -->
```js
// Input
const link = <a href="example.com">http://example.com</a>

// Output (Prettier 1.15)
// Error: Comment location overlaps with node location

// Output (Prettier 1.16)
const link = <a href="example.com">http://example.com</a>;
```

#### Remove redundant parentheses around type annotations ([#5724] by [@flurmbo])

<!-- prettier-ignore -->
```js
// Input
class Foo {
  bar: (() => boolean);
}

// Output (Prettier 1.15)
class Foo {
  bar: (() => boolean);
}

// Output (Prettier 1.16)
class Foo {
  bar: () => boolean;
}
```

### JavaScript

#### Do not treat `something.connect()` as functional composition ([#5739] by [@makepost])

The special handling for `connect()` was introduced for Redux several release
ago, but it turns out this pattern is too common that it may not be suitable to
always apply the functional composition formatting. Those unsuitable cases could
be summed up as `something.connect()`, so we stopped to treat them as functional
composition in 1.16.

<!-- prettier-ignore -->
```js
// Input
app.connect("activate", async () => {
  await data.load();
  win.show_all();
});
const ConnectedComponent = connect(
  bar,
  baz
)(foo);

// Output (Prettier 1.15)
app.connect(
  "activate",
  async () => {
    await data.load();
    win.show_all();
  }
);
const ConnectedComponent = connect(
  bar,
  baz
)(foo);

// Output (Prettier 1.16)
app.connect("activate", async () => {
  await data.load();
  win.show_all();
});
const ConnectedComponent = connect(
  bar,
  baz
)(foo);
```

#### Add support for class private methods ([#5637] by [@existentialism])

```js
// Input
class Hello {
  #world() {}
}

// Output (Prettier 1.15)
// SyntaxError

// Output (Prettier 1.16)
class Hello {
  #world() {}
}
```

#### Correct indentation for expressions in root template ([#5607] by [@ikatyang])

<!-- prettier-ignore -->
```js
// Input
if (a) {
  return `
hello
${foo({
  bar,
  baz
})}
world
`;
}

// Output (Prettier 1.15)
if (a) {
  return `
hello
${foo({
    bar,
    baz
  })}
world
`;
}

// Output (Prettier 1.16)
if (a) {
  return `
hello
${foo({
  bar,
  baz
})}
world
`;
}
```

### TypeScript/Flow

#### Correctly recognize `/* HTML */` templates ([#5658] by [@ikatyang])

We added support for [`/* HTML */` template formatting][html-comment-template]
in 1.15, but it somehow only works for `babylon`. We've fixed this issue in
1.16.

[html-comment-template]:
  https://prettier.io/blog/2018/11/07/1.15.0.html#html-template-literal-in-javascript

### CSS

#### Fix broken output for lists casued by comments ([#5710] by [@jsnajdr])

<!-- prettier-ignore -->
```scss
// Input
$my-list2:
  a // a
  b
  c;

// Output (Prettier 1.15)
$my-list2: a// a
  bc;

// Output (Prettier 1.16)
$my-list2: a // a
  b c;
```

#### Correctly handle backslashes ([#5597] by [@sh7dm])

<!-- prettier-ignore -->
```less
// Input
.figcaption {
    .margin-top-1\/2;
    .large\:none;
}

// Output (Prettier 1.15)
.figcaption {
  .margin-top-1\ / 2;
  .large\: none;
}

// Output (Prettier 1.16)
.figcaption {
  .margin-top-1\/2;
  .large\: none;
}
```

### MDX

#### Correctly handle inline html ([#5704] by [@ikatyang])

<!-- prettier-ignore -->
```md
<!-- Input -->
| Column 1 | Column 2 |
|---|---|
| Text | <Hello>Text</Hello> |

<!-- Output (Prettier 1.15) -->
<!-- SyntaxError -->

<!-- Output (Prettier 1.16) -->
| Column 1 | Column 2            |
| -------- | ------------------- |
| Text     | <Hello>Text</Hello> |
```

### HTML

#### Format script with type "application/ld+json" ([#5642] by [@ikatyang])

<!-- prettier-ignore -->
```html
<!-- Input -->
<script type="application/ld+json">
  {   "json":true  }
</script>

<!-- Output (Prettier 1.15) -->
<script type="application/ld+json">
  {   "json":true  }
</script>

<!-- Output (Prettier 1.16) -->
<script type="application/ld+json">
  { "json": true }
</script>
```

#### Treat `.mjml` files as HTML ([#5505] by [@n1ru4l])

MJML is a markup language that uses the same syntax as HTML, we added its
extension name `.mjml` to the list of HTML extension names so that it should be
recognized by default.

#### Smart quote for attributes ([#5590] by [@ikatyang])

Previously, attributes quotes were always printed as double quotes. To improve
readability, they are now printed as the quote type that will produce fewer
escapes.

<!-- prettier-ignore -->
```html
<!-- Input -->
<div x='123"456'></div>
<div x="123'456"></div>

<!-- Output (Prettier 1.15) -->
<div x="123&quot;456"></div>
<div x="123'456"></div>

<!-- Output (Prettier 1.16) -->
<div x='123"456'></div>
<div x="123'456"></div>
```

### Vue

#### Tag names are case-sensitive ([#5606] by [@ikatyang])

Previously, we lowercased tag names before querying tag definition while
parsing, which causes `<Input>` component to be recognized as `<input>` and
produces a syntax error on `</Input>` since void elements could not be closed.
We've fixed this issue in 1.16.

<!-- prettier-ignore -->
```vue
<!-- Input -->
<template>
  <Input></Input>
</template>

<!-- Output (Prettier 1.15) -->
<!-- SyntaxError -->

<!-- Output (Prettier 1.16) -->
<template>
  <Input></Input>
</template>
```

### Vue/Angular

#### Add parentheses to avoid unexpected `}}` in interpolations ([#5657] by [@ikatyang])

`}}` is not allowed to be used in a interpolation since it'll be recognized as
interpolation ending, we've added parentheses for cases that may produce invalid
`}}` in 1.16.

<!-- prettier-ignore -->
```html
<!-- Input -->
<p>{{ foo({ bar: {} }) }}</p>

<!-- First Output (Prettier 1.15, --no-bracket-spacing) -->
<p>{{ foo({bar: {}}) }}</p>

<!-- Second Output (Prettier 1.15, --no-bracket-spacing) -->
<!-- SyntaxError -->

<!-- Output (Prettier 1.16, --no-bracket-spacing) -->
<p>{{ foo({bar: ({})}) }}</p>
```

[@existentialism]: https://github.com/existentialism
[@flurmbo]: https://github.com/flurmbo
[@ikatyang]: https://github.com/ikatyang
[@j-f1]: https://github.com/j-f1
[@jameshenry]: https://github.com/JamesHenry
[@jsnajdr]: https://github.com/jsnajdr
[@kachkaev]: https://github.com/kachkaev
[@lhchavez]: https://github.com/lhchavez
[@makepost]: https://github.com/makepost
[@n1ru4l]: https://github.com/n1ru4l
[@sh7dm]: https://github.com/sh7dm
[@wuweiweiwu]: https://github.com/wuweiweiwu
[#5494]: https://github.com/prettier/prettier/pull/5494
[#5505]: https://github.com/prettier/prettier/pull/5505
[#5590]: https://github.com/prettier/prettier/pull/5590
[#5596]: https://github.com/prettier/prettier/pull/5596
[#5597]: https://github.com/prettier/prettier/pull/5597
[#5606]: https://github.com/prettier/prettier/pull/5606
[#5607]: https://github.com/prettier/prettier/pull/5607
[#5608]: https://github.com/prettier/prettier/pull/5608
[#5612]: https://github.com/prettier/prettier/pull/5612
[#5629]: https://github.com/prettier/prettier/pull/5629
[#5632]: https://github.com/prettier/prettier/pull/5632
[#5637]: https://github.com/prettier/prettier/pull/5637
[#5642]: https://github.com/prettier/prettier/pull/5642
[#5647]: https://github.com/prettier/prettier/pull/5647
[#5657]: https://github.com/prettier/prettier/pull/5657
[#5658]: https://github.com/prettier/prettier/pull/5658
[#5685]: https://github.com/prettier/prettier/pull/5685
[#5704]: https://github.com/prettier/prettier/pull/5704
[#5710]: https://github.com/prettier/prettier/pull/5710
[#5724]: https://github.com/prettier/prettier/pull/5724
[#5728]: https://github.com/prettier/prettier/pull/5728
[#5739]: https://github.com/prettier/prettier/pull/5739
